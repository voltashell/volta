(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2956:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(5155),s=a(2115),n=a(4298);let l=(0,a(5028).default)(()=>Promise.all([a.e(651),a.e(806),a.e(368)]).then(a.bind(a,9368)),{loadableGenerated:{webpack:()=>[9368]},ssr:!1,loading:()=>(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:"Loading terminal..."})}),o={"agent-1":"text-red-400","agent-2":"text-teal-400","agent-3":"text-blue-400",nats:"text-yellow-400"};function c(e){let{name:t,displayName:a,logs:n,commandResults:c,stats:i,onRestart:d,onClearLogs:m,onCommand:x,className:g}=e,[u,h]=(0,s.useState)(!0),[b,p]=(0,s.useState)(""),[y,f]=(0,s.useState)("logs"),N=(0,s.useRef)(null),v=[...n,...c.map(e=>({container:t,timestamp:e.timestamp,data:"$ ".concat(e.command,"\n").concat(e.output||"").concat(e.error?"\nError: ".concat(e.error):""),isError:!!e.error,isCommand:!0}))].sort((e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime());(0,s.useEffect)(()=>{u&&N.current&&(N.current.scrollTop=N.current.scrollHeight)},[v,u]);let j=e=>{e.preventDefault(),b.trim()&&(x(b.trim(),t),p(""))};return(0,r.jsxs)("div",{className:"bg-gray-900 flex flex-col overflow-hidden ".concat(g),children:[(0,r.jsxs)("div",{className:"bg-gray-800 px-3 py-2 border-b border-gray-600 flex justify-between items-center",children:[(0,r.jsx)("div",{className:"font-bold text-sm ".concat(o[t]),children:a}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>{confirm("Restart ".concat(a,"?"))&&d(t)},className:"bg-red-600 hover:bg-red-500 text-white text-xs px-2 py-1 rounded",children:"Restart"}),(0,r.jsx)("button",{onClick:()=>m(t),className:"bg-gray-600 hover:bg-gray-500 text-white text-xs px-2 py-1 rounded",children:"Clear"})]})]}),(0,r.jsxs)("div",{className:"flex border-b border-gray-600",children:[(0,r.jsx)("button",{onClick:()=>f("logs"),className:"px-4 py-2 text-sm font-medium ".concat("logs"===y?"bg-gray-800 text-white border-b-2 border-blue-500":"bg-gray-900 text-gray-400 hover:text-white"),children:"Logs"}),(0,r.jsx)("button",{onClick:()=>f("terminal"),className:"px-4 py-2 text-sm font-medium ".concat("terminal"===y?"bg-gray-800 text-white border-b-2 border-blue-500":"bg-gray-900 text-gray-400 hover:text-white"),children:"Terminal"})]}),(0,r.jsx)("div",{className:"px-3 py-1 border-b border-gray-600 text-xs",children:i?(0,r.jsxs)("div",{className:"text-gray-400",children:["Status: ",(0,r.jsx)("span",{className:"text-green-400",children:"Running"})," | ","CPU: ",i.CPUPerc||"0%"," | ","Memory: ",i.MemUsage||"0B / 0B"]}):(0,r.jsxs)("div",{className:"text-gray-400",children:["Status: ",(0,r.jsx)("span",{className:"text-red-400",children:"Unknown"})]})}),"logs"===y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{ref:N,onScroll:()=>{if(!N.current)return;let{scrollTop:e,scrollHeight:t,clientHeight:a}=N.current;h(e+a>=t-5)},className:"flex-1 p-2 overflow-y-auto text-xs font-mono bg-gray-950 scrollbar-thin scrollbar-track-gray-800 scrollbar-thumb-gray-600",style:{minHeight:0},children:0===v.length?(0,r.jsx)("div",{className:"text-gray-500 italic",children:"No logs available"}):v.map((e,t)=>(0,r.jsxs)("div",{className:"mb-1 break-words ".concat(e.isCommand?"bg-gray-900 px-1 py-0.5 rounded":""),children:[(0,r.jsx)("span",{className:"text-gray-500 mr-2",children:new Date(e.timestamp).toLocaleTimeString()}),(0,r.jsx)("span",{className:"".concat(e.isCommand?"text-cyan-400":((e,t)=>{if(t)return"text-red-400";let a=e.toLowerCase();return a.includes("error")||a.includes("failed")?"text-red-400":a.includes("warn")?"text-yellow-400":a.includes("connected")||a.includes("started")||a.includes("ready")?"text-green-400":"text-white"})(e.data,e.isError)),children:e.data.trim()})]},t))}),(0,r.jsx)("form",{onSubmit:j,className:"border-t border-gray-600 bg-gray-800",children:(0,r.jsxs)("div",{className:"flex items-center px-2 py-2 space-x-2",children:[(0,r.jsx)("span",{className:"text-green-400 font-bold text-xs min-w-fit",children:"$"}),(0,r.jsx)("input",{type:"text",value:b,onChange:e=>p(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j(e))},placeholder:"Command for ".concat(a,"..."),className:"flex-1 bg-transparent text-white text-xs font-mono border-none outline-none placeholder-gray-500"}),(0,r.jsx)("button",{type:"submit",disabled:!b.trim(),className:"bg-green-600 hover:bg-green-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white text-xs px-2 py-1 rounded",children:"Send"})]})})]}):(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,r.jsx)(l,{containerName:t})}),"logs"===y&&!u&&(0,r.jsx)("div",{className:"absolute bottom-12 right-2",children:(0,r.jsx)("button",{onClick:()=>{N.current&&(N.current.scrollTop=N.current.scrollHeight,h(!0))},className:"bg-blue-600 hover:bg-blue-500 text-white text-xs px-2 py-1 rounded shadow-lg",children:"â†“ New logs"})})]})}var i=a(9509);function d(){let[e,t]=(0,s.useState)(null),[a,l]=(0,s.useState)({connected:!1}),[o,d]=(0,s.useState)({"agent-1":[],"agent-2":[],"agent-3":[],nats:[]}),[m,x]=(0,s.useState)([]),[g,u]=(0,s.useState)({"agent-1":[],"agent-2":[],"agent-3":[],nats:[]});(0,s.useEffect)(()=>{let e=i.env.NEXT_PUBLIC_WEBSOCKET_URL||"http://localhost:3001",a=(0,n.io)(e,{transports:["websocket","polling"]});return t(a),a.on("connect",()=>{l({connected:!0,lastSeen:new Date})}),a.on("disconnect",()=>{l({connected:!1})}),a.on("log",e=>{let t=e.container;t in o&&d(a=>({...a,[t]:[...a[t].slice(-999),e]}))}),a.on("stats",e=>{x(e)}),a.on("command-result",e=>{let t=e.target;t in g&&u(a=>({...a,[t]:[...a[t].slice(-49),e]}))}),a.on("container-restarted",e=>{console.log("Container restart result:",e)}),a.on("error",e=>{console.error("Container error:",e)}),()=>{a.close()}},[]);let h=(t,a)=>{if(!e)return;let r={command:t,target:a,timestamp:new Date().toISOString()};e.emit("execute-command",r)},b=t=>{e&&e.emit("restart-container",t)},p=e=>{d(t=>({...t,[e]:[]}))},y=e=>m.find(t=>t.Name===e),f=(()=>{if(0===m.length)return{containers:0,cpu:0,memory:0};let e=m.reduce((e,t)=>{var a;return e+parseFloat((null==(a=t.CPUPerc)?void 0:a.replace("%",""))||"0")},0),t=m.reduce((e,t)=>{var a,r;return e+parseFloat((null==(r=t.MemUsage)||null==(a=r.split(" / ")[0])?void 0:a.replace(/[^\d.]/g,""))||"0")},0);return{containers:m.length,cpu:e.toFixed(1),memory:t.toFixed(0)}})();return(0,r.jsxs)("div",{className:"h-screen flex flex-col bg-gray-900 text-white overflow-hidden",children:[(0,r.jsx)("div",{className:"fixed top-3 right-4 z-50",children:(0,r.jsx)("div",{className:"px-2 py-1 rounded text-xs font-bold ".concat(a.connected?"bg-green-600 text-white":"bg-red-600 text-white"),children:a.connected?"Connected":"Disconnected"})}),(0,r.jsxs)("header",{className:"bg-gray-800 px-5 py-3 border-b border-gray-600 flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-lg font-bold text-green-400",children:"AI Flock Monitor"}),(0,r.jsxs)("div",{className:"flex space-x-6 text-xs",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-gray-400",children:"Containers"}),(0,r.jsx)("div",{className:"text-green-400 font-bold",children:f.containers})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-gray-400",children:"CPU"}),(0,r.jsxs)("div",{className:"text-green-400 font-bold",children:[f.cpu,"%"]})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-gray-400",children:"Memory"}),(0,r.jsxs)("div",{className:"text-green-400 font-bold",children:[f.memory,"MB"]})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 grid-rows-2 gap-px bg-gray-600 flex-1 overflow-hidden",children:[(0,r.jsx)(c,{name:"agent-1",displayName:"Agent 1",logs:o["agent-1"],commandResults:g["agent-1"],stats:y("agent-1"),onRestart:b,onClearLogs:p,onCommand:h,className:"relative"}),(0,r.jsx)(c,{name:"agent-2",displayName:"Agent 2",logs:o["agent-2"],commandResults:g["agent-2"],stats:y("agent-2"),onRestart:b,onClearLogs:p,onCommand:h,className:"relative"}),(0,r.jsx)(c,{name:"agent-3",displayName:"Agent 3",logs:o["agent-3"],commandResults:g["agent-3"],stats:y("agent-3"),onRestart:b,onClearLogs:p,onCommand:h,className:"relative"}),(0,r.jsx)(c,{name:"nats",displayName:"NATS Server",logs:o.nats,commandResults:g.nats,stats:y("nats"),onRestart:b,onClearLogs:p,onCommand:h,className:"relative"})]})]})}},3688:(e,t,a)=>{Promise.resolve().then(a.bind(a,2956))}},e=>{e.O(0,[887,441,964,358],()=>e(e.s=3688)),_N_E=e.O()}]);